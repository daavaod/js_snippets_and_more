// ****** Higher-Order Functions ******
// The functions that use other functions as arguments or return functions are named higher-order functions.
// The functions that use only primitives or objects as arguments, and only return primitives or objects are named first-order functions.

const companies= [
  {name: "Company One", category: "Finance", start: 1981, end: 2004},
  {name: "Company Two", category: "Retail", start: 1992, end: 2008},
  {name: "Company Three", category: "Auto", start: 1999, end: 2007},
  {name: "Company Four", category: "Retail", start: 1989, end: 2010},
  {name: "Company Five", category: "Technology", start: 2009, end: 2014},
  {name: "Company Six", category: "Finance", start: 1987, end: 2010},
  {name: "Company Seven", category: "Auto", start: 1986, end: 1996},
  {name: "Company Eight", category: "Technology", start: 2011, end: 2016},
  {name: "Company Nine", category: "Retail", start: 1981, end: 1989}
];

const ages = [33, 12, 20, 16, 5, 54, 21, 44, 61, 13, 15, 45, 25, 64, 32];

// for(let i = 0; i < companies.length; i++) {
//   console.log(companies[i]);
// }

// forEach

// companies.forEach(function(company) {
//   console.log(company.name);
// });

// filter

// Get 21 and older

// let canDrink = [];
// for(let i = 0; i < ages.length; i++) {
//   if(ages[i] >= 21) {
//     canDrink.push(ages[i]);
//   }
// }

// const canDrink = ages.filter(function(age) {
//   if(age >= 21) {
//     return true;
//   }
// });

const canDrink = ages.filter(age => age >= 21);

// Filter retail companies

// const retailCompanies = companies.filter(function(company) {
//   if(company.category === 'Retail') {
//     return true;
//   }
// });

const retailCompanies = companies.filter(company => company.category === 'Retail');

// Get 80s companies

const eightiesCompanies = companies.filter(company => (company.start >= 1980 && company.start < 1990));

// Get companies that lasted 10 years or more

const lastedTenYears = companies.filter(company => (company.end - company.start >= 10));

// map

// Create array of company names
// const companyNames = companies.map(function(company) {
//   return company.name;
// });

// const testMap = companies.map(function(company) {
//   return `${company.name} [${company.start} - ${company.end}]`;
// });

// const testMap = companies.map(company => `${company.name} [${company.start} - ${company.end}]`);

// const ageMap = ages
//   .map(age => Math.sqrt(age))
//   .map(age => age * 2);



// sort

// Sort companies by start year

// const sortedCompanies  = companies.sort(function(c1, c2) {
//   if(c1.start > c2.start) {
//     return 1;
//   } else {
//     return -1;
//   }
// });

// const sortedCompanies = companies.sort((a, b) => (a.start > b.start ? 1 : -1));

// Sort ages
// const sortAges = ages.sort((a, b) => a - b);

// console.log(sortAges);

// ‚úÖ Sort in Descending order
const strArr1 = ['a', 'c', 'z', 'f'];
const descArr = strArr1.sort().reverse();
console.log(descArr); // üëâÔ∏è ['z', 'f', 'c', 'a']

// ‚úÖ Sort in Descending order (Alternative)
const strArr2 = ['a', 'c', 'z', 'f'];
const descArr2 = strArr2.sort((a, b) => (a > b ? -1 : 1));
console.log(descArr2); // üëâÔ∏è ['z', 'f', 'c', 'a']

// ‚úÖ Sort in ascending order
const strArr3 = ['z', 'c', 'a', 'f'];
const ascArr = strArr3.sort();
console.log(ascArr); // üëâÔ∏è ['a', 'c', 'f', 'z']

// with no mutation
// ‚úÖ Sort in Descending order
const strArr1 = ['a', 'c', 'z', 'f'];
const descArr = [...strArr1].sort().reverse();

console.log(descArr); // üëâÔ∏è ['z', 'f', 'c', 'a']
console.log(strArr1); // üëâÔ∏è ['a', 'c', 'z', 'f']

// ‚úÖ Sort in Descending order (Alternative)
const strArr2 = ['a', 'c', 'z', 'f'];
const descArr2 = [...strArr2].sort((a, b) => (a > b ? -1 : 1));
console.log(descArr2); // üëâÔ∏è ['z', 'f', 'c', 'a']


// reduce

// let ageSum = 0;
// for(let i = 0; i < ages.length; i++) {
//   ageSum += ages[i];
// }

// const ageSum = ages.reduce(function(total, age) {
//   return total + age;
// }, 0);

// const ageSum = ages.reduce((total, age) => total + age, 0);

// Get total years for all companies

// const totalYears = companies.reduce(function(total, company) {
//   return total + (company.end - company.start);
// }, 0);

const totalYears = companies.reduce((total, company) => total + (company.end - company.start), 0);

// Combine Methods

const combined = ages
  .map(age => age * 2)
  .filter(age => age >= 40)
  .sort((a, b) => a - b)
  .reduce((a, b) => a + b, 0);

console.log(combined);

// Get the intersection of two arrays
const intersection = (x, y) => {
  const set = new Set(x);
  return [...new Set(y.filter((i) => set.has(i)))];
};

// üéâ [2]
console.log(intersection([1, 2, 2, 3], [2, 2, 5]));

// Group arrays by function
const groupBy = (arr, fn) =>
  arr.map(fn).reduce((acc, cur, i) => {
    acc[cur] = [...(acc[cur] || []), arr[i]];
    return acc;
  }, {});

// üéâ { number: [ 1, 3 ], string: [ '2', '4' ] }
console.log(groupBy([1, '2', 3, '4'], (val) => typeof val));

// üéâ { '1': [ [ 1 ], [ 3 ] ], '2': [ [ 1, 2 ], [ 3, 4 ] ] }
console.log(groupBy([[1], [1, 2], [3], [3, 4]], (val) => val.length));

// Format the bytes
const formatBytes = (bytes, decimals = 2) => {
  if (bytes < 0) return '';
  if (bytes <= 1) return `${bytes} B`;
  const k = 1024;
  const dm = decimals < 0 ? 0 : decimals;
  const sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return `${parseFloat((bytes / k ** i).toFixed(dm))}${sizes[i]}`;
};

// üéâ 1KB
console.log(formatBytes(1024));

// üéâ 1MB
console.log(formatBytes(1024 ** 2));

// Format money
const formatMoney = (num) =>
  num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');

// üéâ '20,220,316'
console.log(formatMoney(20220316));

// Generate random string with specified length
const randomString = (len) => {
  const chars = 'abcdefhijkmnprstwxyz123456789ABCDEFGHJKMNPQRSTWXYZ';
  const totalLength = chars.length;
  let randomStr = '';

  for (let i = 0; i < len; i += 1) {
    randomStr += chars.charAt(Math.floor(Math.random() * totalLength));
  }
  return randomStr;
};

// üéâ 'k4RrA5'
console.log(randomString(6));

// Full screen browser
const toFullScreen = () => {
  document.documentElement[
    [
      'requestFullscreen',
      'mozRequestFullScreen',
      'msRequestFullscreen',
      'webkitRequestFullscreen',
    ].find((fn) => typeof document.documentElement[fn] === 'function')
  ]?.();
};

// Valid JSON
const isValidJSON = (str) => {
  try {
    JSON.parse(str);
    return true;
  } catch {
    return false;
  }
};

// üéâ true
console.log(isValidJSON(JSON.stringify({ age: 30 })));

// üéâ false
console.log(isValidJSON('{age:30}'));

// array uniques
const numbers = [1,2,2,3,4,4,4,5,6,7,7]
const names = ["John", "Mads", "Bob", "John", "Bob"]

const uniqueNumbers = [...new Set(numbers)]
// [1,2,3,4,5,6,7]
const uniqueNames = [...new Set(names)]
// ['John', 'Mads', 'Bob']

// unique objects from an array by key
let countriesUnique = Object.values(countries.reduce((acc:any, obj:any) => ({ ...acc, [obj.country]: obj }), {}));

// javascript-interview-questions
https://www.interviewbit.com/javascript-interview-questions

// media queries image swap
<picture>
  <source srcset="https://via.placeholder.com/1400" media="(min-width: 1400px)"/>
  <source srcset="https://via.placeholder.com/1200" media="(min-width: 1200px)"/>
  <source srcset="https://via.placeholder.com/800" media="(min-width: 800px)"/>
  <source srcset="https://via.placeholder.com/600" media="(min-width: 600px)"/>
  <img src="https://via.placeholder.com/400" alt="example"/>
</picture>

//ùöúùöùùöõùöíùöóùöê ùöñùöéùöùùöëùöòùöçùöú cheatsheet
‚úî ùöÉùöëùöé ùê¨ùê•ùê¢ùêúùêû() ùöñùöéùöùùöëùöòùöç ùöéùö°ùöùùöõùöäùöåùöùùöú ùöä ùöúùöéùöåùöùùöíùöòùöó ùöòùöè ùöä ùöúùöùùöõùöíùöóùöê ùöäùöóùöç ùöõùöéùöùùöûùöõùöóùöú ùöíùöù ùöäùöú ùöä ùöóùöéùö† ùöúùöùùöõùöíùöóùöê, ùö†ùöíùöùùöëùöòùöûùöù ùöñùöòùöçùöíùöèùö¢ùöíùöóùöê ùöùùöëùöé ùöòùöõùöíùöêùöíùöóùöäùöï ùöúùöùùöõùöíùöóùöê.

‚úî ùöÉùöëùöé ùê¨ùêÆùêõùê¨ùê≠ùê´ùê¢ùêßùê†() ùöñùöéùöùùöëùöòùöç ùöõùöéùöùùöûùöõùöóùöú ùöùùöëùöé ùöôùöäùöõùöù ùöòùöè ùöùùöëùöé ùöúùöùùöõùöíùöóùöê ùöãùöéùöùùö†ùöéùöéùöó ùöùùöëùöé ùöúùöùùöäùöõùöù ùöäùöóùöç ùöéùöóùöç ùöíùöóùöçùöéùö°ùöéùöú, ùöòùöõ ùöùùöò ùöùùöëùöé ùöéùöóùöç ùöòùöè ùöùùöëùöé ùöúùöùùöõùöíùöóùöê.

‚úî ùöÉùöëùöé ùê¨ùêÆùêõùê¨ùê≠ùê´() ùöñùöéùöùùöëùöòùöç ùöõùöéùöùùöûùöõùöóùöú ùöä ùöôùöòùöõùöùùöíùöòùöó ùöòùöè ùöùùöëùöé ùöúùöùùöõùöíùöóùöê, ùöúùöùùöäùöõùöùùöíùöóùöê ùöäùöù ùöùùöëùöé ùöúùöôùöéùöåùöíùöèùöíùöéùöç ùöíùöóùöçùöéùö° ùöäùöóùöç ùöéùö°ùöùùöéùöóùöçùöíùöóùöê ùöèùöòùöõ ùöä ùöêùöíùöüùöéùöó ùöóùöûùöñùöãùöéùöõ ùöòùöè ùöåùöëùöäùöõùöäùöåùöùùöéùöõùöú ùöäùöèùöùùöéùöõùö†ùöäùöõùöçùöú.

‚úî ùöÉùöëùöé ùê´ùêûùê©ùê•ùêöùêúùêû() ùöñùöéùöùùöëùöòùöç ùöõùöéùöùùöûùöõùöóùöú ùöä ùöóùöéùö† ùöúùöùùöõùöíùöóùöê ùö†ùöíùöùùöë ùöúùöòùöñùöé ùöòùöõ ùöäùöïùöï ùöñùöäùöùùöåùöëùöéùöú ùöòùöè ùöä ùöôùöäùöùùöùùöéùöõùöó ùöõùöéùöôùöïùöäùöåùöéùöç ùöãùö¢ ùöä ùöõùöéùöôùöïùöäùöåùöéùöñùöéùöóùöù. ùöÉùöëùöé ùöôùöäùöùùöùùöéùöõùöó ùöåùöäùöó ùöãùöé ùöä ùöúùöùùöõùöíùöóùöê ùöòùöõ ùöä ùöÅùöéùöêùô¥ùö°ùöô, ùöäùöóùöç ùöùùöëùöé ùöõùöéùöôùöïùöäùöåùöéùöñùöéùöóùöù ùöåùöäùöó ùöãùöé ùöä ùöúùöùùöõùöíùöóùöê ùöòùöõ ùöä ùöèùöûùöóùöåùöùùöíùöòùöó ùöùùöò ùöãùöé ùöåùöäùöïùöïùöéùöç ùöèùöòùöõ ùöéùöäùöåùöë ùöñùöäùöùùöåùöë. ùô∏ùöè ùöôùöäùöùùöùùöéùöõùöó ùöíùöú ùöä ùöúùöùùöõùöíùöóùöê, ùöòùöóùöïùö¢ ùöùùöëùöé ùöèùöíùöõùöúùöù ùöòùöåùöåùöûùöõùöõùöéùöóùöåùöé ùö†ùöíùöïùöï ùöãùöé ùöõùöéùöôùöïùöäùöåùöéùöç. ùöÉùöëùöé ùöòùöõùöíùöêùöíùöóùöäùöï ùöúùöùùöõùöíùöóùöê ùöíùöú ùöïùöéùöèùöù ùöûùöóùöåùöëùöäùöóùöêùöéùöç.

‚úî ùöÉùöëùöé ùê©ùêöùêùùêíùê≠ùêöùê´ùê≠() ùöñùöéùöùùöëùöòùöç ùöôùöäùöçùöú ùöùùöëùöé ùöåùöûùöõùöõùöéùöóùöù ùöúùöùùöõùöíùöóùöê ùö†ùöíùöùùöë ùöäùöóùöòùöùùöëùöéùöõ ùöúùöùùöõùöíùöóùöê (ùöñùöûùöïùöùùöíùöôùöïùöé ùöùùöíùöñùöéùöú, ùöíùöè ùöóùöéùöéùöçùöéùöç) ùöûùöóùöùùöíùöï ùöùùöëùöé ùöõùöéùöúùöûùöïùöùùöíùöóùöê ùöúùöùùöõùöíùöóùöê ùöõùöéùöäùöåùöëùöéùöú ùöùùöëùöé ùöêùöíùöüùöéùöó ùöïùöéùöóùöêùöùùöë. ùöÉùöëùöé ùöôùöäùöçùöçùöíùöóùöê ùöíùöú ùöäùöôùöôùöïùöíùöéùöç ùöèùöõùöòùöñ ùöùùöëùöé ùöúùöùùöäùöõùöù ùöòùöè ùöùùöëùöé ùöåùöûùöõùöõùöéùöóùöù ùöúùöùùöõùöíùöóùöê.

‚úî ùöÉùöëùöé ùê©ùêöùêùùêÑùêßùêù() ùöñùöéùöùùöëùöòùöç ùöôùöäùöçùöú ùöùùöëùöé ùöåùöûùöõùöõùöéùöóùöù ùöúùöùùöõùöíùöóùöê ùö†ùöíùöùùöë ùöä ùöêùöíùöüùöéùöó ùöúùöùùöõùöíùöóùöê (ùöõùöéùöôùöéùöäùöùùöéùöç, ùöíùöè ùöóùöéùöéùöçùöéùöç) ùöúùöò ùöùùöëùöäùöù ùöùùöëùöé ùöõùöéùöúùöûùöïùöùùöíùöóùöê ùöúùöùùöõùöíùöóùöê ùöõùöéùöäùöåùöëùöéùöú ùöä ùöêùöíùöüùöéùöó ùöïùöéùöóùöêùöùùöë. ùöÉùöëùöé ùöôùöäùöçùöçùöíùöóùöê ùöíùöú ùöäùöôùöôùöïùöíùöéùöç ùöèùöõùöòùöñ ùöùùöëùöé ùöéùöóùöç ùöòùöè ùöùùöëùöé ùöåùöûùöõùöõùöéùöóùöù ùöúùöùùöõùöíùöóùöê.

"wonderful".at(-1)                // l
"wonderful".charAt(2)             // n
"wonderful".concat(" ","house")   // wonderful house
"wonderful".endsWith("q")         // false
"wonderful".startsWith("W")       // true
"wonderful".includes("der")       // true
"wonderful".indexOf("d")          // 3
"wonderful".split("")             // ["w","o","n","d","e","r","f","u","l"]
"wonderful".padStart(20, ".")     // ...........wonderful
"wonderful".padEnd(20, ".")       // wonderful...........
"wonderful".repeat(3)             // wonderfulwonderfulwonderful
"wonderful".replace("ful", "")    // wonder
"wonderful".search("f")           // 6
"wonderful".substr(3,4)           // derf
"wonderful".substring(3,4)        // d
"wonderful".slice(3,4)            // d
"wonderful".toUpperCase()         // WONDERFUL
"wonderful".toLowerCase()         // wonderful

// simple sort by date desc
array.sort(function(a,b){
  return new Date(b.date) - new Date(a.date);
});

// upload file base64
const toBase64 = file => new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
});

async function Main() {
   const file = document.querySelector('#myfile').files[0];
   console.log(await toBase64(file));
}

Main();

// with errors
async function Main() {
   const file = document.querySelector('#myfile').files[0];
   try {
      const result = await toBase64(file);
      return result
   } catch(error) {
      console.error(error);
      return;
   }
   //...
}

// group array objects by key
var cars = [{ make: 'audi', model: 'r8', year: '2012' }, { make: 'audi', model: 'rs5', year: '2013' }, { make: 'ford', model: 'mustang', year: '2012' }, { make: 'ford', model: 'fusion', year: '2015' }, { make: 'kia', model: 'optima', year: '2012' }],
    result = cars.reduce(function (r, a) {
        r[a.make] = r[a.make] || [];
        r[a.make].push(a);
        return r;
    }, Object.create(null));

console.log(result);

// Month and Date in 2 digit format?
("0" + this.getDate()).slice(-2) // date
("0" + (this.getMonth() + 1)).slice(-2) // month

// Map months by custom name
const monthNames = ["January", "February", "March", "April", "May", "June",
  "July", "August", "September", "October", "November", "December"
];
const month = monthNames[new Date(obj.start).getMonth()],

// set css var
setCustomStyle() {
  // get document root
  const root = document.querySelector(":root");

  // get table name form table title
  let tableName = this.title.split(" ")[0].toLowerCase();

  // set table name class
  this.classSuffix = tableName;

  // round up items in columns
  let columnItems = Math.ceil(this.documents.length / 2);

  // set global var style
  root.style.setProperty(`--column-items-${tableName}`, columnItems);
},

// Blob
var saveJson = function(obj) {
	var str = JSON.stringify(obj);
	var data = encode( str );

	var blob = new Blob( [ data ], {
		type: 'application/octet-stream'
	});
	
	var url = URL.createObjectURL( blob );
	var link = document.createElement( 'a' );
	link.setAttribute( 'href', url );
	link.setAttribute( 'download', 'data.json' );
	var event = document.createEvent( 'MouseEvents' );
	event.initMouseEvent( 'click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);
	link.dispatchEvent( event );
}


var encode = function( s ) {
	var out = [];
	for ( var i = 0; i < s.length; i++ ) {
		out[i] = s.charCodeAt(i);
	}
	return new Uint8Array( out );
}

// Updating properties in multiple objects
const arr1 = [
  {id: 1, name: 'Alice'},
  {id: 1, name: 'Bob'},
  {id: 3, name: 'Charlie'},
];
const newArr = arr1.map(obj => {
  if (obj.id === 1) {
    return {...obj, name: 'Alfred'};
  }

  return obj;
});

//hex to rgb
const hextToRgb = (color: any) => {
	// color without #

	// setting the value to the user input 
	let hexVal = color;

	// turn 3-HEX to 6-HEX
	if ( hexVal.length === 3 ) {
	hexVal = hexVal[0] + hexVal[0] + hexVal[1] + hexVal[1] + hexVal[2] + hexVal[2];
	} 

	// extracting the hex values for RGB
	let red = hexVal.substr(0,2),
	green = hexVal.substr(2,2),
	blue = hexVal.substr(4,2);

	// converting in decimal values
	let red10 = parseInt(red,16),
	green10 = parseInt(green,16),
	blue10 = parseInt(blue,16);

	// stitching it together
	let rgb = red10+','+green10+','+blue10;

	return rgb
}

// group and sort data by month (react example)
const groupByMonth = (data: any) => {
	// group data by month
	const result = data.reduce(function (r:any, a:any) {
	    r[a.mesec] = r[a.mesec] || [];
	    r[a.mesec].push(a);
	    return r;
	}, Object.create(null));

	return result
}
const sortByMonth = (data: any) => {
	const monthNames = ["January", "February", "March", "April", "May", "June",
	    "July", "August", "September", "October", "November", "December"
	];
	const addMonth = data.map((obj:any) => {
	    return {
	    mesec: monthNames[new Date(obj.start).getMonth()],
	    ...obj
	    }
	})

	const newValues = groupByMonth(addMonth);

	// convert to array
	let entries = Object.entries(newValues);

	// sort array by monthNames
	const sortByMonth = entries.sort(function(a:any, b:any){
	    return monthNames.indexOf(a[0]) - monthNames.indexOf(b[0])
	});

	// set filtered events by month
	setCalendarEventsMonth(sortByMonth)
}

// change if else code
// from
const getPriceByName = (name) => {
  if (name === 'üçî') {
    return 30
  } else if (name === 'üç®') {
    return 20
  } else if (name === 'üçø') {
    return 10
  }
}
console.log(getPriceByName('üçî')) // 30

// to
const getPriceByName = (name) => {
  const foodMap = {
    'üçî': 30,
    'üç®': 20,
    'üçø': 10,
    // You can add new food here
    // ...
  }
  return foodMap[ name ]
}
console.log(getPriceByName('üçî')) // 30

// search delay
let timer;              // Timer identifier
const waitTime = 500;   // Wait time in milliseconds 

// Search function
const search = (text) => {
    // TODO: Make HTTP Request HERE
};

// Listen for `keyup` event
const input = document.querySelector('#input-text');
input.addEventListener('keyup', (e) => {
    const text = e.currentTarget.value;

    // Clear timer
    clearTimeout(timer);

    // Wait for X ms and then process the request
    timer = setTimeout(() => {
        search(text);
    }, waitTime);
});

// url params

urlParams() {
    const url = window.location.href;
    const stringItems = new URLSearchParams(url);

    const params = {};

    for(const [key, value] of stringItems) {
	params[key] = value;
    }

    return params;
},
